<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Facebook Connect</title>

    <style>
        .rounded {

            padding-top: 20px;
            padding-bottom: 10px;
            border-radius:5px;
        }
        label{
            color: white;
        }
    </style>

    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/socialMediaIconCSS.css" rel="stylesheet">

</head>
<body style="background: #3b5998">
<script>
    var token = document.URL;
    var FB;
    var accessToken;

    window.fbAsyncInit = function() {
        FB.init({
            appId      : '331246753731437',
            xfbml      : true,
            version    : 'v2.2'
        });
    };

    (function(d, s, id){
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/en_US/sdk.js";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));


    function FBLogin() {
        // redirects page to Facebook
        // once login success sends back to facebookLogin.html with a token and time in seconds until token expires (5184000 seconds / 60 days)
        // we need to research and see if there is a way to
        // Look into Login Review for facebook Permissions
        window.location.href ='https://www.facebook.com/dialog/oauth?client_id=331246753731437&response_type=token&redirect_uri=http://localhost:63342/PostOP/app/data/content/facebookLogin.html';

        console.log("bitch");


//
//        FB.getLoginStatus(function(response) {
//            if (response.status === 'connected') {
//                console.log(response.authResponse.accessToken);
//            }
//        });

    }


    // runs on page ready
    // after login to facebook, sets var token = auth token from facebook


    // for some reason when the URL is directed back you have to use the FB.login(); to be able to use
    // the facebook api. I have tried this on window.onload and document.ready, neither work because the
    // api is loaded asynchronously. :( lets figure this out.
    //
    // if we do not use FB.login(), we need to find another way to obtain the access token because we will not
    // be able to use FB.getAccessToken();


    //document.ready(console.log(FB.login()));
    window.onload(urlChecker());
    function urlChecker () {
        var accessToken = FB.getAccessToken();
        token = token.toString();
        //console.log("furst token " + token[1]);
        token = token.split("=");
        //console.log("sucond token " + token[1]);
        token = token[1].split("&");
        //parses facebook login response token and prints auth token
        token = token[0];
        console.log("token === " + token);


        (function(theUrl, tok,end,access)
        {
            var xmlHttp = null;

            console.log(theUrl+token+end+access);
            xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "GET", theUrl+tok+end, false );
            xmlHttp.send( null );
            return xmlHttp.responseText;
        }("https://graph.facebook.com/debug_token?input_token=", token,"&access_token=",accessToken));

    }

</script>
<div class="container">
    <div class="row">
        <h3 class="text-center" style="color: #ffffff; margin-bottom: 10%"> Would you like to connect to Facebook? </h3>
    </div>
        <div class="form-group col-xs-12" style="padding-top: 3%">
            <button id = "yes" class="btn btn-lg center-block" onclick="FBLogin()" style="background: black; color: #ffffff;">Yes</button>
        </div>
    <div class="form-group col-xs-12" style="padding-top: 3%">
        <button id = "no" class="btn btn-lg center-block" style="background: black; color: #ffffff;">No</button>
    </div>

        <!--<div class="row">-->
        <!--<div class="text-center" style="padding-bottom: 5%">-->
        <!--<h4>Available Social Media Sites</h4>-->
        <!--&lt;!&ndash; just add href= for your links, like this: &ndash;&gt;-->
        <!--<a href="http://facebook.com" class="btn btn-social-icon btn-facebook">-->
        <!--<i class="fa fa-facebook"></i></a>-->

        <!--<a class="btn btn-social-icon btn-google-plus"><i class="fa fa-google-plus"></i></a>-->
        <!--<a class="btn btn-social-icon btn-instagram"><i class="fa fa-instagram"></i></a>-->
        <!--<a class="btn btn-social-icon btn-twitter"><i class="fa fa-twitter"></i></a>-->
        <!--</div>-->
        <!--</div>-->
    </div>
</div>
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
</body>
</html>
</html>
